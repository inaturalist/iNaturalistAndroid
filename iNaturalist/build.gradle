buildscript {
    repositories {
        maven { url "http://dl.bintray.com/populov/maven" }
        mavenCentral()
        maven { url 'https://maven.fabric.io/public' }
        maven { url "https://jitpack.io" }
    }

    dependencies {
        classpath 'io.fabric.tools:gradle:1.+'
    }
}
apply plugin: 'com.android.application'
apply plugin: 'io.fabric'

configurations {
    all {
        exclude module: 'httpclient'
    }
}

repositories {
    maven { url "http://dl.bintray.com/populov/maven" }
    mavenCentral()
    maven { url 'https://maven.fabric.io/public' }
}

allprojects {
    repositories {
        maven {
            url 'https://maven.google.com'
        }
    }
}

android {
    compileSdkVersion 27
    buildToolsVersion '28.0.3'
    useLibrary 'org.apache.http.legacy'

    lintOptions {
        checkReleaseBuilds false
    }

    dexOptions {
        javaMaxHeapSize "4g"
    }

    defaultConfig {
        applicationId "org.inaturalist.android"
        minSdkVersion 15
        targetSdkVersion 26
        multiDexEnabled true
        renderscriptTargetApi 18
        renderscriptSupportModeEnabled true
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"


        /*
         * This is done because smoothrescale uses mmpeg shared library binaries, which are not compiled
         * to newer arm64-v8a (just to x86/armeabi-v7a). And once we have *any* 64 bit shared libraries in
         * our binary, Android 7+ will automatically try and look for the 64 bit shared libraries instead
         * of the 32 bit ones - so we exclude those 64 bit libraries (see here and under gradle.properties).
         * Full solution here: https://corbt.com/posts/2015/09/18/mixing-32-and-64bit-dependencies-in-android.html
         */

        ndk {
            abiFilters "armeabi-v7a", "x86"
        }

        packagingOptions {
            exclude '/lib/mips64/**'
            exclude '/lib/arm64-v8a/**'
            exclude '/lib/x86_64/**'
        }
    }

    buildTypes {
        debug {
            minifyEnabled false
        }
        release {
            minifyEnabled true
            proguardFiles 'proguard-rules.txt'
        }
    }

    packagingOptions {
        exclude 'META-INF/DEPENDENCIES'
        exclude 'META-INF/NOTICE'
        exclude 'META-INF/LICENSE'
        exclude 'META-INF/LICENSE.txt'
        exclude 'META-INF/NOTICE.txt'
        exclude 'LICENSE.txt'
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_7
        targetCompatibility JavaVersion.VERSION_1_7
    }
}

dependencies {
    implementation 'com.android.support:multidex:1.0.1'
    implementation project(':library')
    implementation project(':urlImageViewHelper')
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation 'com.android.support:appcompat-v7:27.0.2'
    implementation files('libs/FlurryAnalytics-4.2.0.jar')
    implementation('com.crashlytics.sdk.android:crashlytics:2.4.0@aar') {
        transitive = true;
    }
    implementation 'jp.wasabeef:picasso-transformations:2.1.2'
    implementation 'com.android.support:design:27.0.2'
    implementation 'com.android.support:support-v4:27.0.2'
    implementation 'com.google.android.gms:play-services:10.2.1'
    implementation 'org.apache.commons:commons-collections4:4.0'
    implementation 'org.apache.commons:commons-lang3:3.1'
    implementation 'org.apache.httpcomponents:httpclient-android:4.3.5.1'
    implementation 'org.apache.httpcomponents:httpmime:4.3.3'
    implementation 'com.facebook.android:facebook-android-sdk:4.38.0'
    implementation 'com.loopj.android:android-async-http:1.4.7'
    implementation 'com.melnykov:floatingactionbutton:1.3.0'
    implementation 'org.apache.sanselan:sanselan:0.97-incubator'
    implementation 'com.cocosw:bottomsheet:1.+@aar'
    implementation 'org.lucasr.twowayview:twowayview:0.1.4'
    implementation 'com.github.JakeWharton:ViewPagerIndicator:2.4.1'
    implementation 'joda-time:joda-time:2.4'
    implementation 'com.google.android.gms:play-services-ads:7.3.0'
    implementation 'com.google.android.gms:play-services-identity:7.3.0'
    implementation 'com.google.android.gms:play-services-gcm:10.2.1'
    implementation 'com.android.support:preference-v7:27.0.2'
    implementation 'com.amplitude:android-sdk:2.13.2'
    implementation 'com.squareup.picasso:picasso:2.5.2'
    implementation 'com.mikhaellopez:circularprogressbar:1.1.1'
    implementation 'com.android.support:exifinterface:27.0.2'
    implementation 'io.jsonwebtoken:jjwt:0.7.0'
    implementation 'com.github.budowski:android-maps-utils:0.5.2'
    implementation project(':smoothrescale')
    implementation 'com.github.drewnoakes:metadata-extractor:321551df00'
    implementation 'com.github.bumptech.glide:glide:4.2.0'
    implementation 'com.github.livefront:bridge:v1.1.2'
    implementation 'com.evernote:android-state:1.3.1'
    implementation 'com.github.PhilJay:MPAndroidChart:v3.1.0-alpha'
    annotationProcessor 'com.evernote:android-state-processor:1.3.1'
    annotationProcessor 'com.github.bumptech.glide:compiler:4.2.0'
    androidTestImplementation 'com.android.support:support-annotations:27.0.2'
    androidTestImplementation 'com.android.support.test:runner:0.4.1'
    androidTestImplementation 'com.android.support.test:rules:0.4.1'
    androidTestImplementation 'org.hamcrest:hamcrest-library:1.3'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:2.2.1'
}
